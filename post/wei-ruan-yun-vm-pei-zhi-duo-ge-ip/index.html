<html>

<head>
    <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>
    微软云 vm配置多个ip | 51cloud
</title>
<link rel="shortcut icon" href="https://51yun.github.io/favicon.ico?v=1761028624221">
<!-- <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous"> -->
<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://51yun.github.io/styles/main.css">
<!-- js -->
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
<script src="https://51yun.github.io/media/js/jquery.sticky-sidebar.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/moment.js/2.23.0/moment.min.js"></script>


        
</head>

<body>
    <div class="main">
        <div class="header">
    <div class="nav">
        <div class="logo">
            <a href="https://51yun.github.io">
                <img class="avatar" src="https://51yun.github.io/images/avatar.png?v=1761028624221" alt="">
            </a>
            <div class="site-title">
                <h1>
                    51cloud
                </h1>
            </div>
        </div>
        <span class="menu-btn fa fa-align-justify"></span>
        <div class="menu-container">
            <ul>
                
                    
                            <li>
                                <a href="/" class="menu">
                                    首页
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/archives" class="menu">
                                    所有文档
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/tags" class="menu">
                                    标签
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/post/about" class="menu">
                                    关于
                                </a>
                            </li>
                            
                                
            </ul>
        </div>
    </div>
</div>

<script>
    $(document).ready(function() {
        $(".menu-btn").click(function() {
            $(".menu-container").slideToggle();
        });
        $(window).resize(function() {

            if (window.matchMedia('(min-width: 960px)').matches) {
                $(".menu-container").css('display', 'block')
            } else {
                $(".menu-container").css('display', 'none')
            }

        });
    });
</script>

            <div id="main-content" class="post-detail main-container">
                <!-- left -->
                <div id="content" class="main-container-left">
                    <article class="post i-card">
                        <h2 class="post-title">
                            微软云 vm配置多个ip
                        </h2>
                        <div class="post-info">
                            <time class="post-time">2025-10-06</time>
                            
                                <a href="https://51yun.github.io/tag/zZm4I2bPKn/" class="post-tag i-tag
                            i-tag-warning">
                            #微软云
                        </a>
                                
                        </div>
                        
                                <div class="post-content">
                                    <p>如果你还没有创建虚拟机实例 请参考这里  <a href="https://51yun.github.io/post/wei-ruan-yun-chuang-jian-xu-ni-ji/#1%E7%99%BB%E5%BD%95%E5%90%8E%E6%90%9C%E7%B4%A2vm-%E8%BF%9B%E5%85%A5%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%A1%B5%E9%9D%A2">创建虚拟机实例教学</a></p>
<!-- more -->
<h3 id="找到虚拟机实例">找到虚拟机实例</h3>
<figure data-type="image" tabindex="1"><img src="https://51yun.github.io/post-images/image-20251006141224160.png" alt="image-20251006141224160" loading="lazy"></figure>
<figure data-type="image" tabindex="2"><img src="https://51yun.github.io/post-images/image-20251006141238249.png" alt="image-20251006141238249" loading="lazy"></figure>
<figure data-type="image" tabindex="3"><img src="https://51yun.github.io/post-images/image-20251006141300862.png" alt="image-20251006141300862" loading="lazy"></figure>
<figure data-type="image" tabindex="4"><img src="https://51yun.github.io/post-images/image-20251006141313932.png" alt="image-20251006141313932" loading="lazy"></figure>
<figure data-type="image" tabindex="5"><img src="https://51yun.github.io/post-images/image-20251006141351544.png" alt="image-20251006141351544" loading="lazy"></figure>
<figure data-type="image" tabindex="6"><img src="https://51yun.github.io/post-images/image-20251006141423118.png" alt="image-20251006141423118" loading="lazy"></figure>
<h5 id="辅助ip-还需要改成静态-以免服务器配置好后-ip变动-还要修改服务器配置">辅助ip 还需要改成静态 以免服务器配置好后 ip变动 还要修改服务器配置</h5>
<figure data-type="image" tabindex="7"><img src="https://51yun.github.io/post-images/image-20251006141607998.png" alt="image-20251006141607998" loading="lazy"></figure>
<figure data-type="image" tabindex="8"><img src="https://51yun.github.io/post-images/image-20251006141710562.png" alt="image-20251006141710562" loading="lazy"></figure>
<figure data-type="image" tabindex="9"><img src="https://51yun.github.io/post-images/image-20251006141728778.png" alt="image-20251006141728778" loading="lazy"></figure>
<h3 id="服务器内部配置">服务器内部配置</h3>
<h5 id="1-ssh登录后sudo-su-root-切换到管理员用户后使用-ip-a-命令-找到需要的信息-如-网卡名称-子网掩码">1 ssh登录后，sudo su - root 切换到管理员用户后，使用 ip a 命令 找到需要的信息 如 网卡名称 子网掩码</h5>
<figure data-type="image" tabindex="10"><img src="https://51yun.github.io/post-images/image-20251006141801017.png" alt="image-20251006141801017" loading="lazy"></figure>
<h5 id="2-根据上面得到的信息-添加希望ip到系统-私网ip生效了-公网就生效了-因为是关联关系">2 根据上面得到的信息 添加希望ip到系统 私网ip生效了 公网就生效了 因为是关联关系</h5>
<pre><code class="language-shell"># 已知信息 网卡 eth0 子网掩码24
# 上面控制台的时候 已经得知我们新建的 两个辅助ip 为 10.0.0.5 10.0.0.6
#注意 命令中的ip 子网 和网卡名称 替换成自己的
#以下操作需要使用 sudo su - root 命令切换到管理员再操作

# 使用命令添加私网ip(值钱配置静态ip的时候能看到每个公网ip 对应的私网ip) eth0是上一步得到的网卡名称
root@name:~# ip addr add 10.0.0.5/24 dev eth0
root@name:~# ip addr add 10.0.0.6/24 dev eth0

# 验证是否添加成功
root@name:~# ip addr show eth0
2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen
1000
 link/ether 60:45:bd:57:aa:b0 brd ff:ff:ff:ff:ff:ff
 inet 10.0.0.4/24 metric 100 brd 10.0.0.255 scope global eth0
 valid_lft forever preferred_lft forever
 inet 10.0.0.5/24 scope global secondary eth0
 valid_lft forever preferred_lft forever
 inet 10.0.0.6/24 scope global secondary eth0
 valid_lft forever preferred_lft forever
 inet6 fe80::6245:bdff:fe57:aab0/64 scope link
 valid_lft forever preferred_lft foreve
#上面验证 ip已经生效 但重启后 还会失效 需要配置开启自动添加

</code></pre>
<h3 id="3-开机自动添加ip">3 开机自动添加ip</h3>
<figure data-type="image" tabindex="11"><img src="https://51yun.github.io/post-images/image-20251006142152851.png" alt="image-20251006142152851" loading="lazy"></figure>
<pre><code class="language-shell">cat &lt;&lt;EOF &gt;/etc/rc.local
#!/bin/sh -e
ip addr add 10.0.0.5/24 dev eth0
ip addr add 10.0.0.6/24 dev eth0
exit 0
EOF
##上面的命令全部复制后粘贴到命令行运行 不是一行行粘贴 注意替换成你的私网ip 和网卡名称
</code></pre>
<pre><code class="language-shell">##rc.local 文件添加执行权限
chmod +x /etc/rc.local
#此时有些系统如centOS 等 重启已经可以自动添加ip了 必须 重启确认一下
</code></pre>
<h3 id="4-rclocal-不生效问题解决重启确认不生效后操作否则可能会启动不起来">4 rc.local 不生效问题解决（重启确认不生效后操作否则可能会启动不起来）</h3>
<p>已知 乌班图 22-24 debian9-12 重启都不生效的</p>
<figure data-type="image" tabindex="12"><img src="https://51yun.github.io/post-images/image-20251006142444002.png" alt="image-20251006142444002" loading="lazy"></figure>
<pre><code class="language-shell">cat &lt;&lt;EOF &gt;/etc/systemd/system/rc-local.service
[Unit]
Description=/etc/rc.local
ConditionFileIsExecutable=/etc/rc.local
After=network.target
[Service]
Type=forking
ExecStart=/etc/rc.local start
TimeoutSec=0
RemainAfterExit=yes
GuessMainPID=no
[Install]
WantedBy=multi-user.target
EOF
#上面的命令后 全部复制粘贴运行 不是一行行粘贴
</code></pre>
<p>自启动生效配置</p>
<pre><code>chmod +x /etc/rc.local &amp;&amp; systemctl daemon-reload &amp;&amp; systemctl enable rc-local
</code></pre>
<h5 id="最后就是重启-验证是否-自动开启辅助ip-重启命令-init-6-或-reboot-使用-ip-a-命令验证">最后就是重启 验证是否 自动开启辅助ip 重启命令 init 6 或 reboot 使用 ip a 命令验证</h5>
<figure data-type="image" tabindex="13"><img src="https://51yun.github.io/post-images/image-20251006142710250.png" alt="image-20251006142710250" loading="lazy"></figure>
<h5 id="这里看到-重启后ip生效了-此时-对应的两个新的公网ip-也生效了">这里看到 重启后ip生效了 此时 对应的两个新的公网ip 也生效了</h5>

                                </div>
                    </article>
                    <!--  -->
                    
                        <div class="next-post">
                            <div class="next">下一篇</div>
                            <a href="https://51yun.github.io/post/wei-ruan-yun-chuang-jian-xu-ni-ji/">
                                <h3 class="post-title">
                                    微软云 创建虚拟机
                                </h3>
                            </a>
                        </div>
                        
                            <div id="disqus_thread"></div>
                            <div id="gitalk-container"></div>
                </div>
                <!-- middle -->
                <div class="main-container-middle"></div>
                <!-- right -->
                <div id="sidebar" class="main-container-right">
                    
                        <!-- toc -->
                        
    <div class="toc-card i-card ">
        <div class="toc-title i-card-title">目录</div>
        <div class="toc-content">
            <ul class="markdownIt-TOC">
<li>
<ul>
<li>
<ul>
<li><a href="#%E6%89%BE%E5%88%B0%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AE%9E%E4%BE%8B">找到虚拟机实例</a><br>
*
<ul>
<li><a href="#%E8%BE%85%E5%8A%A9ip-%E8%BF%98%E9%9C%80%E8%A6%81%E6%94%B9%E6%88%90%E9%9D%99%E6%80%81-%E4%BB%A5%E5%85%8D%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE%E5%A5%BD%E5%90%8E-ip%E5%8F%98%E5%8A%A8-%E8%BF%98%E8%A6%81%E4%BF%AE%E6%94%B9%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE">辅助ip 还需要改成静态 以免服务器配置好后 ip变动 还要修改服务器配置</a></li>
</ul>
</li>
<li><a href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%86%85%E9%83%A8%E9%85%8D%E7%BD%AE">服务器内部配置</a><br>
*
<ul>
<li><a href="#1-ssh%E7%99%BB%E5%BD%95%E5%90%8Esudo-su-root-%E5%88%87%E6%8D%A2%E5%88%B0%E7%AE%A1%E7%90%86%E5%91%98%E7%94%A8%E6%88%B7%E5%90%8E%E4%BD%BF%E7%94%A8-ip-a-%E5%91%BD%E4%BB%A4-%E6%89%BE%E5%88%B0%E9%9C%80%E8%A6%81%E7%9A%84%E4%BF%A1%E6%81%AF-%E5%A6%82-%E7%BD%91%E5%8D%A1%E5%90%8D%E7%A7%B0-%E5%AD%90%E7%BD%91%E6%8E%A9%E7%A0%81">1 ssh登录后，sudo su - root 切换到管理员用户后，使用 ip a 命令 找到需要的信息 如 网卡名称 子网掩码</a></li>
<li><a href="#2-%E6%A0%B9%E6%8D%AE%E4%B8%8A%E9%9D%A2%E5%BE%97%E5%88%B0%E7%9A%84%E4%BF%A1%E6%81%AF-%E6%B7%BB%E5%8A%A0%E5%B8%8C%E6%9C%9Bip%E5%88%B0%E7%B3%BB%E7%BB%9F-%E7%A7%81%E7%BD%91ip%E7%94%9F%E6%95%88%E4%BA%86-%E5%85%AC%E7%BD%91%E5%B0%B1%E7%94%9F%E6%95%88%E4%BA%86-%E5%9B%A0%E4%B8%BA%E6%98%AF%E5%85%B3%E8%81%94%E5%85%B3%E7%B3%BB">2 根据上面得到的信息 添加希望ip到系统 私网ip生效了 公网就生效了 因为是关联关系</a></li>
</ul>
</li>
<li><a href="#3-%E5%BC%80%E6%9C%BA%E8%87%AA%E5%8A%A8%E6%B7%BB%E5%8A%A0ip">3 开机自动添加ip</a></li>
<li><a href="#4-rclocal-%E4%B8%8D%E7%94%9F%E6%95%88%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E9%87%8D%E5%90%AF%E7%A1%AE%E8%AE%A4%E4%B8%8D%E7%94%9F%E6%95%88%E5%90%8E%E6%93%8D%E4%BD%9C%E5%90%A6%E5%88%99%E5%8F%AF%E8%83%BD%E4%BC%9A%E5%90%AF%E5%8A%A8%E4%B8%8D%E8%B5%B7%E6%9D%A5">4 rc.local 不生效问题解决（重启确认不生效后操作否则可能会启动不起来）</a><br>
*
<ul>
<li><a href="#%E6%9C%80%E5%90%8E%E5%B0%B1%E6%98%AF%E9%87%8D%E5%90%AF-%E9%AA%8C%E8%AF%81%E6%98%AF%E5%90%A6-%E8%87%AA%E5%8A%A8%E5%BC%80%E5%90%AF%E8%BE%85%E5%8A%A9ip-%E9%87%8D%E5%90%AF%E5%91%BD%E4%BB%A4-init-6-%E6%88%96-reboot-%E4%BD%BF%E7%94%A8-ip-a-%E5%91%BD%E4%BB%A4%E9%AA%8C%E8%AF%81">最后就是重启 验证是否 自动开启辅助ip 重启命令 init 6 或 reboot 使用 ip a 命令验证</a></li>
<li><a href="#%E8%BF%99%E9%87%8C%E7%9C%8B%E5%88%B0-%E9%87%8D%E5%90%AF%E5%90%8Eip%E7%94%9F%E6%95%88%E4%BA%86-%E6%AD%A4%E6%97%B6-%E5%AF%B9%E5%BA%94%E7%9A%84%E4%B8%A4%E4%B8%AA%E6%96%B0%E7%9A%84%E5%85%AC%E7%BD%91ip-%E4%B9%9F%E7%94%9F%E6%95%88%E4%BA%86">这里看到 重启后ip生效了 此时 对应的两个新的公网ip 也生效了</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
        <script>
            function locateCatelogList() {
                /*获取文章目录集合,可通过:header过滤器*/
                var alis = $('.post-content :header');
                /*获取侧边栏目录列表集合**/
                var sidebar_alis = $('.markdownIt-TOC a');
                /*获取滚动条到顶部的距离*/
                var scroll_height = $(window).scrollTop();
                for (var i = 0; i < alis.length; i++) {
                    /*获取锚点集合中的元素分别到顶点的距离*/
                    var a_height = $(alis[i]).offset().top;
                    if (a_height < scroll_height) {
                        /*高亮显示*/
                        sidebar_alis.removeClass('on');
                        $(sidebar_alis[i]).addClass('on');
                    }
                }
            }
            $(function() {
                /*绑定滚动事件 */
                $(window).bind('scroll', locateCatelogList);
            });
        </script>
    </div>
    
                            

                </div>




            </div>


            <div class="site-footer">
  Powered by 51cloud.cloud
 | 
  <a class="rss" href="https://51yun.github.io/atom.xml" target="_blank">RSS</a>
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>


    </div>
    <script>
        $('#sidebar').stickySidebar({
            topSpacing: 80,
            // bottomSpacing: 60
        });
    </script>
    
</body>

</html>